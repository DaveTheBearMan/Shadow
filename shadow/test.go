package main

import "golang.org/x/net/bpf"

func testTCPPacket(vm *bpf.VM) {
	testData := []byte{0x84, 0x70, 0xd7, 0xf6, 0xec, 0x12, 0xbc, 0x0f, 0xf3, 0x62, 0x57, 0x09, 0x08, 0x00, 0x45, 0x00, 0x00, 0x39, 0x00, 0x01, 0x00, 0x00, 0x40, 0x06, 0x23, 0x5c, 0xa9, 0xfe, 0x17, 0x0c, 0x81, 0x15, 0x15, 0x43, 0x30, 0x39, 0x00, 0x16, 0x00, 0x00, 0x03, 0xe8, 0x00, 0x00, 0x00, 0x00, 0x50, 0x02, 0x20, 0x00, 0xfd, 0x5b, 0x00, 0x00, 0x5b, 0x53, 0x48, 0x41, 0x44, 0x4f, 0x57, 0x5d, 0x65, 0x63, 0x68, 0x6f, 0x20, 0x54, 0x65, 0x73, 0x74}
	outputFrameLen, err := vm.Run(testData)
	if err != nil {
		panic("Test filter failed")
	}
	if outputFrameLen <= 0 {
		panic("Test filter failed to pass any packets")
	}
	// fmt.Printf("Test data length %d\n", len(testData))
	// fmt.Printf("Returned value %d\n", outputFrameLen)
	// fmt.Printf("% x\n", testData)
}
